{% extends "base.html" %}

{% block title %}건강 정보 조회 - 뇌졸중 예방 시스템{% endblock %}

{% set active_menu = 'health-inquiry' %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}

<!-- 로딩 스피너 -->
<div id="loadingSpinner" class="flex justify-center items-center h-96">
    <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-teal-600"></div>
</div>

<!-- 데이터 없음 메시지 -->
<div id="noDataMessage" class="hidden max-w-6xl mx-auto">
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center">
        <i data-lucide="inbox" class="w-16 h-16 mx-auto text-gray-300 mb-4"></i>
        <h3 class="text-xl font-bold text-gray-800 mb-2">건강 데이터가 없습니다</h3>
        <p class="text-gray-500 mb-6">건강 정보를 먼저 입력해주세요.</p>
        <a href="/patient/basic-info" class="inline-flex items-center gap-2 bg-teal-600 hover:bg-teal-700 text-white px-6 py-3 rounded-xl font-bold transition">
            <i data-lucide="plus"></i>
            건강 정보 입력하기
        </a>
    </div>
</div>

<!-- 메인 컨텐츠 (데이터가 있을 때만 표시) -->
<div id="mainContent" class="hidden max-w-6xl mx-auto">
    
    <!-- 상단 헤더 카드 4개 -->
    <div class="grid grid-cols-4 gap-6 mb-8">
        <!-- 혈압 카드 -->
        <button onclick="showChart('혈압')" class="bg-white rounded-2xl shadow-sm border-2 border-gray-100 p-6 hover:border-teal-500 hover:shadow-md transition-all text-left" id="card-혈압">
            <h3 class="text-gray-500 text-sm mb-2">혈압</h3>
            <p class="text-3xl font-bold text-gray-800" id="value-혈압">-</p>
            <p class="text-xs text-gray-400 mt-1">mmHg</p>
        </button>

        <!-- 혈당 카드 -->
        <button onclick="showChart('혈당')" class="bg-white rounded-2xl shadow-sm border-2 border-gray-100 p-6 hover:border-teal-500 hover:shadow-md transition-all text-left" id="card-혈당">
            <h3 class="text-gray-500 text-sm mb-2">혈당</h3>
            <p class="text-3xl font-bold text-gray-800" id="value-혈당">-</p>
            <p class="text-xs text-gray-400 mt-1">mg/dL</p>
        </button>

        <!-- BMI 카드 -->
        <button onclick="showChart('BMI')" class="bg-white rounded-2xl shadow-sm border-2 border-gray-100 p-6 hover:border-teal-500 hover:shadow-md transition-all text-left" id="card-BMI">
            <h3 class="text-gray-500 text-sm mb-2">BMI</h3>
            <p class="text-3xl font-bold text-gray-800" id="value-BMI">-</p>
            <p class="text-xs text-gray-400 mt-1">kg/m²</p>
        </button>

        <!-- 위험도 점수 카드 -->
        <button onclick="showChart('위험도')" class="bg-white rounded-2xl shadow-sm border-2 border-gray-100 p-6 hover:border-teal-500 hover:shadow-md transition-all text-left" id="card-위험도">
            <h3 class="text-gray-500 text-sm mb-2">위험도 점수</h3>
            <p class="text-3xl font-bold text-gray-800" id="value-위험도">-</p>
            <p class="text-xs text-gray-400 mt-1">점</p>
        </button>
    </div>

    <!-- 그래프 카드 -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
        <div class="mb-6 flex justify-between items-center">
            <div>
                <h2 class="text-xl font-bold text-gray-800"><span id="chartTitle">혈압</span> 건강 지표 추이</h2>
                <p class="text-sm text-gray-500 mt-1">최근 데이터 기록</p>
            </div>
            <button onclick="refreshHealthData()" class="flex items-center gap-2 px-4 py-2 text-teal-600 hover:bg-teal-50 rounded-lg transition">
                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                <span class="text-sm font-medium">새로고침</span>
            </button>
        </div>
        
        <div class="h-96">
            <canvas id="healthChart"></canvas>
        </div>
    </div>

</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/patient/patient_health_data_inquiry.js"></script>
{% endblock %}
