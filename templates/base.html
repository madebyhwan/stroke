<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}뇌졸중 관리 시스템{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', path='css/style.css') }}">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    {% block extra_css %}{% endblock %}
</head>
<body class="text-gray-800 pb-20">
    <!-- 헤더 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
            <a href="#" id="logoLink" class="flex items-center gap-2 font-bold text-xl text-teal-600">
                <i data-lucide="heart-pulse"></i> 
                <span>뇌졸중 관리</span>
            </a>
            {% block header_actions %}
            <!-- 로그인된 경우 사용자 정보 표시 -->
            {% endblock %}
        </div>
    </header>

    <!-- 메인 컨텐츠 -->
    <main class="max-w-md mx-auto p-4 min-h-screen">
        <!-- 플래시 메시지 (알림) -->
        <div id="alert-container"></div>
        
        {% block content %}{% endblock %}
    </main>

    <!-- 하단 네비게이션 (환자 페이지용) -->
    {% block bottom_nav %}{% endblock %}

    <script src="{{ url_for('static', path='js/script.js') }}"></script>
    <script>
    // 로고 링크를 사용자 역할에 따라 설정
    document.addEventListener('DOMContentLoaded', () => {
        const logoLink = document.getElementById('logoLink');
        if (logoLink) {
            const user = storage.get('user');
            if (user && user.role) {
                if (user.role === 'PATIENT') {
                    logoLink.href = '/patient/home';
                } else if (user.role === 'DOCTOR' || user.role === 'CAREGIVER') {
                    logoLink.href = '/monitor/home';
                } else {
                    logoLink.href = '/patient/home';
                }
            } else {
                logoLink.href = '/login';
            }
        }
    });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
